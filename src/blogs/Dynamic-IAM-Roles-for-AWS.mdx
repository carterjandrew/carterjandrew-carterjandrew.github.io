# What does that even mean

Okay, to start, we should have a context of what AWS IAM roles are. An IAM role gives a user access to AWS resources in line with the policy attached to the role. This means we can use the AWS SDKs or the CLI to interact with different resources. Unlike IAM users, IAM roles are not tied to a specific user or group, and they are temporary, meaning the credentials given to a client are only set to work for a limited time (usually an hour) before they expire.

So, why exactly would you want to use dynamic roles like this? Well, there are a couple of compelling reasons:

1. **Temporary Access**: You want users to access a resource without needing a permanent IAM account. For instance, a guest might need access to a shopping cart to view items or checkout, but you don’t want to create and manage an IAM user account for this temporary access.

2. **Enhanced Security**: Dynamic roles can enhance security by limiting the duration and scope of access. For example, you can issue temporary credentials to a user for a specific task, and once the task is completed, the credentials expire. This minimizes the risk of long-term exposure.

3. **Cross-Account Access**: If you need to grant access to resources in a different AWS account, you can use IAM roles. For example, an application in Account A might need to access resources in Account B. You can create a role in Account B that allows Account A to assume it, enabling cross-account resource access.

4. **Federated Access**: You can use IAM roles to provide access to AWS resources for users who are authenticated by external identity providers (e.g., Google, Facebook, or corporate SSO). This is useful for integrating AWS services with existing authentication systems.

## How to Create and Use Dynamic IAM Roles with STS

AWS Security Token Service (STS) is used to create temporary security credentials. Here’s a quick overview of how you can use STS to create dynamic IAM roles:

### 1. **Define an IAM Role**

First, create an IAM role with a policy that defines what resources the role can access. Here’s an example of a simple role policy:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::example-bucket/*"
    }
  ]
}
```

### 2. **Allow STS to Assume the Role**

Modify the role’s trust policy to allow STS to assume the role. For example:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Service": "sts.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
```

### 3. **Use STS to Assume the Role**

You can use the AWS SDK or CLI to assume the role and obtain temporary credentials. Here’s an example using the AWS CLI:

```bash
aws sts assume-role --role-arn "arn:aws:iam::123456789012:role/MyRole" --role-session-name "MySession"
```

This command will return temporary security credentials (Access Key ID, Secret Access Key, and Session Token) that you can use to interact with AWS services.

### 4. **Use the Temporary Credentials**

Configure your AWS SDK or CLI to use the temporary credentials. For example, with the AWS CLI:

```bash
export AWS_ACCESS_KEY_ID="temp-access-key-id"
export AWS_SECRET_ACCESS_KEY="temp-secret-access-key"
export AWS_SESSION_TOKEN="temp-session-token"
```

You can now use these credentials to access AWS resources as defined by the IAM role.

